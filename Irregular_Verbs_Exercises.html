<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ä¸è§„åˆ™åŠ¨è¯ç»ƒä¹ </title>
  <style>
    :root {
      --bg: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      --card: rgba(255, 255, 255, 0.95);
      --accent: #667eea;
      --ok: #10b981;
      --bad: #ef4444;
      --muted: #6b7280;
      --text: #1f2937;
      --border: #e5e7eb;
      --shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
    }
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    html, body {
      height: 100%;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      line-height: 1.6;
    }
    
    body {
      background: var(--bg);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 16px;
      min-height: 100vh;
      color: var(--text);
    }
    
    .wrap {
      width: 100%;
      max-width: 800px;
      animation: fadeIn 0.6s ease-out;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 20px;
      flex-wrap: wrap;
      gap: 12px;
    }
    
    h1 {
      font-size: 24px;
      font-weight: 700;
      color: white;
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
    }
    
    .stats {
      display: flex;
      gap: 16px;
      flex-wrap: wrap;
    }
    
    .stat-item {
      background: rgba(255, 255, 255, 0.2);
      padding: 8px 16px;
      border-radius: 20px;
      color: white;
      font-size: 14px;
      font-weight: 500;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.3);
    }
    
    .card {
      background: var(--card);
      border-radius: 20px;
      padding: 32px;
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      position: relative;
      overflow: hidden;
    }
    
    .card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, #667eea, #764ba2);
    }
    
    .progress-info {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 24px;
      flex-wrap: wrap;
      gap: 12px;
    }
    
    .progress-item {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 14px;
      color: var(--muted);
    }
    
    .progress-number {
      font-weight: 600;
      color: var(--accent);
    }
    
    .accuracy-display {
      background: linear-gradient(135deg, #10b981, #059669);
      color: white;
      padding: 8px 16px;
      border-radius: 20px;
      font-weight: 600;
      font-size: 14px;
      box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
    }
    
    .verb-section {
      text-align: center;
      margin: 32px 0;
      padding: 24px;
      background: linear-gradient(135deg, #f8fafc, #f1f5f9);
      border-radius: 16px;
      border: 1px solid var(--border);
    }
    
    .verb-large {
      font-size: 48px;
      font-weight: 800;
      letter-spacing: -0.5px;
      margin: 16px 0;
      background: linear-gradient(135deg, #667eea, #764ba2);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    .meaning {
      font-size: 18px;
      color: var(--muted);
      margin-top: 8px;
      font-weight: 500;
    }
    
    .hint {
      font-size: 14px;
      color: var(--accent);
      margin-top: 8px;
      font-style: italic;
    }
    
    .verb-selector {
      margin: 24px 0;
    }
    
    select {
      width: 100%;
      padding: 16px;
      border-radius: 12px;
      border: 2px solid var(--border);
      font-size: 16px;
      background: white;
      transition: all 0.3s ease;
      cursor: pointer;
    }
    
    select:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }
    
    .input-group {
      margin: 20px 0;
    }
    
    .input-label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      color: var(--text);
      font-size: 14px;
    }
    
    .input-field {
      width: 100%;
      padding: 16px;
      border-radius: 12px;
      border: 2px solid var(--border);
      font-size: 16px;
      transition: all 0.3s ease;
      background: white;
    }
    
    .input-field:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
      transform: translateY(-2px);
    }
    
    .input-field.ok {
      border-color: var(--ok);
      background: rgba(16, 185, 129, 0.05);
      box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
    }
    
    .input-field.bad {
      border-color: var(--bad);
      background: rgba(239, 68, 68, 0.05);
      box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.1);
    }
    
    .controls {
      display: flex;
      gap: 12px;
      margin-top: 24px;
      flex-wrap: wrap;
    }
    
    button {
      padding: 14px 20px;
      border-radius: 12px;
      border: none;
      font-weight: 600;
      font-size: 16px;
      cursor: pointer;
      transition: all 0.3s ease;
      flex: 1;
      min-width: 120px;
    }
    
    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
    }
    
    button:active {
      transform: translateY(0);
    }
    
    button.primary {
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
    }
    
    button.secondary {
      background: white;
      color: var(--text);
      border: 2px solid var(--border);
    }
    
    button.secondary:hover {
      border-color: var(--accent);
      color: var(--accent);
    }
    
    .status {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-top: 20px;
      padding: 16px;
      background: #f8fafc;
      border-radius: 12px;
      border: 1px solid var(--border);
    }
    
    .status-dot {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }
    
    .status-message {
      font-size: 14px;
      font-weight: 500;
    }
    
    .progress-bar {
      height: 8px;
      background: #e5e7eb;
      border-radius: 4px;
      overflow: hidden;
      margin-top: 16px;
    }
    
    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #667eea, #764ba2);
      transition: width 0.5s ease;
      border-radius: 4px;
    }
    
    .footer {
      margin-top: 24px;
      text-align: center;
      color: rgba(255, 255, 255, 0.8);
      font-size: 14px;
    }
    
    /* å“åº”å¼è®¾è®¡ */
    @media (max-width: 768px) {
      .wrap {
        max-width: 100%;
      }
      
      .card {
        padding: 24px 20px;
        margin: 0 8px;
      }
      
      .verb-large {
        font-size: 36px;
      }
      
      .controls {
        flex-direction: column;
      }
      
      button {
        min-width: auto;
      }
      
      .stats {
        flex-direction: column;
        align-items: stretch;
      }
      
      .progress-info {
        flex-direction: column;
        align-items: stretch;
        gap: 16px;
      }
    }
    
    @media (max-width: 480px) {
      body {
        padding: 12px;
      }
      
      .card {
        padding: 20px 16px;
      }
      
      .verb-large {
        font-size: 32px;
      }
      
      .verb-section {
        padding: 20px 16px;
      }
      
      .input-field {
        padding: 14px;
        font-size: 16px;
      }
      
      select {
        padding: 14px;
        font-size: 16px;
      }
    }
    
    /* è¶…å°å±å¹•é€‚é… */
    @media (max-width: 360px) {
      body {
        padding: 8px;
      }
      
      .card {
        padding: 16px 12px;
        margin: 0 4px;
      }
      
      .verb-large {
        font-size: 28px;
      }
      
      .meaning {
        font-size: 16px;
      }
      
      .progress-info {
        gap: 12px;
      }
      
      .progress-item {
        font-size: 12px;
      }
      
      .accuracy-display {
        font-size: 12px;
        padding: 6px 12px;
      }
      
      button {
        padding: 12px 16px;
        font-size: 14px;
      }
      
      .input-field, select {
        padding: 12px;
        font-size: 16px;
      }
    }
    
    /* æ¨ªå±æ¨¡å¼ä¼˜åŒ– */
    @media (orientation: landscape) and (max-height: 600px) {
      body {
        padding: 8px;
      }
      
      .card {
        padding: 20px;
      }
      
      .verb-section {
        margin: 20px 0;
        padding: 16px;
      }
      
      .verb-large {
        font-size: 32px;
        margin: 12px 0;
      }
      
      .input-group {
        margin: 16px 0;
      }
      
      .controls {
        margin-top: 16px;
      }
      
      .status {
        margin-top: 16px;
        padding: 12px;
      }
    }
    
    /* å¤§å±å¹•ä¼˜åŒ– */
    @media (min-width: 1200px) {
      .wrap {
        max-width: 1000px;
      }
      
      .card {
        padding: 40px;
      }
      
      .verb-large {
        font-size: 56px;
      }
      
      .meaning {
        font-size: 20px;
      }
      
      .input-field, select {
        padding: 18px;
        font-size: 18px;
      }
      
      button {
        padding: 16px 24px;
        font-size: 18px;
      }
    }
    
    /* è§¦æ‘¸è®¾å¤‡ä¼˜åŒ– */
    @media (hover: none) and (pointer: coarse) {
      button {
        min-height: 44px; /* è§¦æ‘¸å‹å¥½çš„æœ€å°é«˜åº¦ */
      }
      
      .input-field, select {
        min-height: 44px;
      }
      
      .verb-selector {
        margin: 20px 0;
      }
      
      select {
        font-size: 16px; /* é˜²æ­¢iOSç¼©æ”¾ */
      }
    }
    
    /* ç´§å‡‘å¸ƒå±€æ ·å¼ */
    .compact-layout .card {
      padding: 20px;
    }
    
    .compact-layout .verb-section {
      margin: 20px 0;
      padding: 16px;
    }
    
    .compact-layout .verb-large {
      margin: 12px 0;
    }
    
    .compact-layout .input-group {
      margin: 16px 0;
    }
    
    .compact-layout .controls {
      margin-top: 16px;
    }
    
    .compact-layout .status {
      margin-top: 16px;
      padding: 12px;
    }
    
    /* è§¦æ‘¸è®¾å¤‡æ ·å¼ */
    .touch-device button {
      -webkit-tap-highlight-color: transparent;
      touch-action: manipulation;
    }
    
    .touch-device .input-field,
    .touch-device select {
      -webkit-tap-highlight-color: transparent;
      touch-action: manipulation;
    }
    
    .touch-device .verb-selector {
      touch-action: manipulation;
    }
    
    /* é«˜åˆ†è¾¨ç‡å±å¹•ä¼˜åŒ– */
    @media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
      .card::before {
        height: 2px;
      }
      
      .progress-bar {
        height: 4px;
      }
      
      .status-dot {
        width: 8px;
        height: 8px;
      }
    }
    
    /* å‡å°‘åŠ¨ç”»åå¥½è®¾ç½® */
    @media (prefers-reduced-motion: reduce) {
      * {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
      
      .wrap {
        animation: none;
      }
      
      button:hover {
        transform: none;
      }
      
      .input-field:focus {
        transform: none;
      }
    }
    
    /* é«˜å¯¹æ¯”åº¦æ¨¡å¼æ”¯æŒ */
    @media (prefers-contrast: high) {
      :root {
        --border: #000000;
        --text: #000000;
        --muted: #000000;
      }
      
      .card {
        border: 2px solid var(--border);
      }
      
      .input-field {
        border-width: 2px;
      }
      
      button {
        border: 2px solid var(--border);
      }
    }
    
    /* æ‰“å°æ ·å¼ */
    @media print {
      body {
        background: white;
        color: black;
      }
      
      .card {
        box-shadow: none;
        border: 1px solid #000;
      }
      
      .controls, .status, .progress-bar {
        display: none;
      }
      
      .verb-section {
        background: white;
        border: 1px solid #000;
      }
    }
    
    /* æ·±è‰²æ¨¡å¼æ”¯æŒ */
    @media (prefers-color-scheme: dark) {
      :root {
        --card: rgba(31, 41, 55, 0.95);
        --text: #f9fafb;
        --border: #374151;
        --bg: linear-gradient(135deg, #1f2937 0%, #111827 100%);
      }
      
      .verb-section {
        background: linear-gradient(135deg, #374151, #4b5563);
        border-color: #4b5563;
      }
      
      .input-field, select {
        background: #374151;
        color: #f9fafb;
        border-color: #4b5563;
      }
      
      .status {
        background: #374151;
        border-color: #4b5563;
      }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card" id="card">
      <div class="progress-info">
        <div class="progress-item">
          åºå· <span class="progress-number" id="index">1</span> / 150
        </div>
        <div class="progress-item">
          æ­£ç¡® <span class="progress-number" id="correctCount">0</span>
        </div>
        <div class="progress-item">
          é”™è¯¯ <span class="progress-number" id="wrongCount">0</span>
        </div>
        <div class="accuracy-display" id="accuracyDisplay">
          æ­£ç¡®ç‡: 0%
        </div>
      </div>

      <div class="verb-section">
        <div class="verb-large" id="baseVerb">be</div>
        <div class="hint" id="hint"></div>
        <div class="meaning" id="meaning">æ˜¯ï¼Œå­˜åœ¨</div>
      </div>

      <div class="verb-selector">
        <select id="verbSelect">
          <option value="all">é€‰æ‹©åŠ¨è¯ç»ƒä¹ </option>
        </select>
      </div>

      <div class="input-group">
        <label class="input-label">è¿‡å»å¼ (Past Simple)</label>
        <input id="pastInput" type="text" class="input-field" autocomplete="off" autocapitalize="none" autocorrect="off" placeholder="è¯·è¾“å…¥è¿‡å»å¼">
      </div>

      <div class="input-group">
        <label class="input-label">è¿‡å»åˆ†è¯ (Past Participle)</label>
        <input id="ppInput" type="text" class="input-field" autocomplete="off" autocapitalize="none" autocorrect="off" placeholder="è¯·è¾“å…¥è¿‡å»åˆ†è¯">
      </div>

      <div class="controls">
        <button id="checkBtn" class="primary">æ£€æŸ¥ç­”æ¡ˆ</button>
        <button class="secondary" id="nextBtn">ä¸‹ä¸€ä¸ª</button>
        <button class="secondary" id="showBtn">æ˜¾ç¤ºç­”æ¡ˆ</button>
        <button class="secondary" id="shuffleBtn">éšæœºé¡ºåº</button>
      </div>

      <div class="status">
        <div class="status-dot" id="dot" style="background: var(--accent);"></div>
        <div class="status-message" id="message">ç­‰å¾…è¾“å…¥ â†’ è¾“å…¥åç‚¹å‡»"æ£€æŸ¥ç­”æ¡ˆ"æˆ–æŒ‰å›è½¦</div>
      </div>

      <div class="progress-bar" aria-hidden="true">
        <div class="progress-fill" id="prog" style="width:0%"></div>
      </div>
    </div>

    <footer class="footer">
      <p>ä¸è§„åˆ™åŠ¨è¯ç»ƒä¹ å·¥å…· - å¼€å‘è€…ï¼šèŒƒå…ˆè®¿</p>
    </footer>
  </div>

  <script>
    // è‡ªé€‚åº”åŠŸèƒ½
    function initAdaptiveFeatures() {
      // æ£€æµ‹è®¾å¤‡ç±»å‹
      const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
      const isTablet = /iPad|Android/i.test(navigator.userAgent) && window.innerWidth >= 768;
      
      // æ ¹æ®è®¾å¤‡ç±»å‹è°ƒæ•´å­—ä½“å¤§å°
      if (isMobile) {
        document.documentElement.style.fontSize = '14px';
      } else if (isTablet) {
        document.documentElement.style.fontSize = '16px';
      } else {
        document.documentElement.style.fontSize = '18px';
      }
      
      // æ£€æµ‹è§¦æ‘¸è®¾å¤‡
      if ('ontouchstart' in window) {
        document.body.classList.add('touch-device');
      }
      
      // æ£€æµ‹å±å¹•æ–¹å‘å˜åŒ–
      window.addEventListener('orientationchange', () => {
        setTimeout(() => {
          // é‡æ–°è®¡ç®—å¸ƒå±€
          window.dispatchEvent(new Event('resize'));
        }, 100);
      });
      
      // æ£€æµ‹çª—å£å¤§å°å˜åŒ–
      let resizeTimer;
      window.addEventListener('resize', () => {
        clearTimeout(resizeTimer);
        resizeTimer = setTimeout(() => {
          // é‡æ–°è®¡ç®—è¿›åº¦æ¡
          updateProgress();
          // è°ƒæ•´å­—ä½“å¤§å°
          adjustFontSize();
        }, 250);
      });
      
      // åˆå§‹è°ƒæ•´å­—ä½“å¤§å°
      adjustFontSize();

      // æ£€æµ‹ç³»ç»Ÿåå¥½è®¾ç½®
      detectSystemPreferences();
      
      // ä¼˜åŒ–è§¦æ‘¸ä½“éªŒ
      optimizeTouchExperience();
    }
    
    // æ£€æµ‹ç³»ç»Ÿåå¥½è®¾ç½®
    function detectSystemPreferences() {
      // æ£€æµ‹æ˜¯å¦æ”¯æŒæ·±è‰²æ¨¡å¼
      if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark-mode');
      }
      
      // æ£€æµ‹æ˜¯å¦å‡å°‘åŠ¨ç”»
      if (window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
        document.body.classList.add('reduced-motion');
      }
      
      // æ£€æµ‹é«˜å¯¹æ¯”åº¦æ¨¡å¼
      if (window.matchMedia && window.matchMedia('(prefers-contrast: high)').matches) {
        document.body.classList.add('high-contrast');
      }
    }
    
    // ä¼˜åŒ–è§¦æ‘¸ä½“éªŒ
    function optimizeTouchExperience() {
      if ('ontouchstart' in window) {
        // é˜²æ­¢åŒå‡»ç¼©æ”¾
        let lastTouchEnd = 0;
        document.addEventListener('touchend', (event) => {
          const now = (new Date()).getTime();
          if (now - lastTouchEnd <= 300) {
            event.preventDefault();
          }
          lastTouchEnd = now;
        }, false);
        
        // ä¼˜åŒ–è§¦æ‘¸åé¦ˆ
        const touchElements = document.querySelectorAll('button, .input-field, select');
        touchElements.forEach(element => {
          element.addEventListener('touchstart', () => {
            element.style.transform = 'scale(0.98)';
          });
          
          element.addEventListener('touchend', () => {
            element.style.transform = '';
          });
        });
      }
    }
    
    // åŠ¨æ€è°ƒæ•´å­—ä½“å¤§å°
    function adjustFontSize() {
      const viewportWidth = window.innerWidth;
      const viewportHeight = window.innerHeight;
      
      // æ ¹æ®è§†å£å¤§å°è°ƒæ•´å­—ä½“
      if (viewportWidth < 480) {
        document.documentElement.style.fontSize = '14px';
      } else if (viewportWidth < 768) {
        document.documentElement.style.fontSize = '16px';
      } else if (viewportWidth < 1200) {
        document.documentElement.style.fontSize = '18px';
      } else {
        document.documentElement.style.fontSize = '20px';
      }
      
      // æ ¹æ®è§†å£é«˜åº¦è°ƒæ•´å‚ç›´é—´è·
      if (viewportHeight < 600) {
        document.body.classList.add('compact-layout');
      } else {
        document.body.classList.remove('compact-layout');
      }
    }

    const verbs = [
      {base:'be', past:'was/were', pp:'been', meaning:'æ˜¯ï¼Œå­˜åœ¨'},
      {base:'have', past:'had', pp:'had', meaning:'æœ‰'},
      {base:'do', past:'did', pp:'done', meaning:'åš'},
      {base:'say', past:'said', pp:'said', meaning:'è¯´'},
      {base:'go', past:'went', pp:'gone', meaning:'å»'},
      {base:'get', past:'got', pp:'got/gotten', meaning:'å¾—åˆ°'},
      {base:'make', past:'made', pp:'made', meaning:'åˆ¶é€ '},
      {base:'know', past:'knew', pp:'known', meaning:'çŸ¥é“'},
      {base:'think', past:'thought', pp:'thought', meaning:'æƒ³'},
      {base:'take', past:'took', pp:'taken', meaning:'æ‹¿'},
      {base:'see', past:'saw', pp:'seen', meaning:'çœ‹è§'},
      {base:'come', past:'came', pp:'come', meaning:'æ¥'},
      {base:'find', past:'found', pp:'found', meaning:'æ‰¾åˆ°'},
      {base:'give', past:'gave', pp:'given', meaning:'ç»™'},
      {base:'tell', past:'told', pp:'told', meaning:'å‘Šè¯‰'},
      {base:'become', past:'became', pp:'become', meaning:'å˜æˆ'},
      {base:'show', past:'showed', pp:'shown', meaning:'æ˜¾ç¤º'},
      {base:'leave', past:'left', pp:'left', meaning:'ç¦»å¼€'},
      {base:'feel', past:'felt', pp:'felt', meaning:'æ„Ÿè§‰'},
      {base:'put', past:'put', pp:'put', meaning:'æ”¾'},
      {base:'bring', past:'brought', pp:'brought', meaning:'å¸¦æ¥'},
      {base:'begin', past:'began', pp:'begun', meaning:'å¼€å§‹'},
      {base:'keep', past:'kept', pp:'kept', meaning:'ä¿æŒ'},
      {base:'hold', past:'held', pp:'held', meaning:'æ¡ä½'},
      {base:'write', past:'wrote', pp:'written', meaning:'å†™'},
      {base:'stand', past:'stood', pp:'stood', meaning:'ç«™ç«‹'},
      {base:'hear', past:'heard', pp:'heard', meaning:'å¬è§'},
      {base:'let', past:'let', pp:'let', meaning:'è®©'},
      {base:'mean', past:'meant', pp:'meant', meaning:'æ„å‘³ç€'},
      {base:'set', past:'set', pp:'set', meaning:'è®¾ç½®'},
      {base:'meet', past:'met', pp:'met', meaning:'é‡è§'},
      {base:'run', past:'ran', pp:'run', meaning:'è·‘'},
      {base:'pay', past:'paid', pp:'paid', meaning:'æ”¯ä»˜'},
      {base:'sit', past:'sat', pp:'sat', meaning:'å'},
      {base:'speak', past:'spoke', pp:'spoken', meaning:'è¯´è¯'},
      {base:'lie', past:'lay', pp:'lain', meaning:'èºº'},
      {base:'lead', past:'led', pp:'led', meaning:'é¢†å¯¼'},
      {base:'read', past:'read', pp:'read', meaning:'è¯»'},
      {base:'grow', past:'grew', pp:'grown', meaning:'ç”Ÿé•¿'},
      {base:'lose', past:'lost', pp:'lost', meaning:'å¤±å»'},
      {base:'fall', past:'fell', pp:'fallen', meaning:'è½ä¸‹'},
      {base:'send', past:'sent', pp:'sent', meaning:'å‘é€'},
      {base:'build', past:'built', pp:'built', meaning:'å»ºé€ '},
      {base:'understand', past:'understood', pp:'understood', meaning:'ç†è§£'},
      {base:'draw', past:'drew', pp:'drawn', meaning:'ç”»'},
      {base:'choose', past:'chose', pp:'chosen', meaning:'é€‰æ‹©'},
      {base:'spend', past:'spent', pp:'spent', meaning:'èŠ±è´¹'},
      {base:'cut', past:'cut', pp:'cut', meaning:'åˆ‡'},
      {base:'rise', past:'rose', pp:'risen', meaning:'ä¸Šå‡'},
      {base:'drive', past:'drove', pp:'driven', meaning:'é©¾é©¶'},
      {base:'buy', past:'bought', pp:'bought', meaning:'ä¹°'},
      {base:'wear', past:'wore', pp:'worn', meaning:'ç©¿'},
      {base:'eat', past:'ate', pp:'eaten', meaning:'åƒ'},
      {base:'drink', past:'drank', pp:'drunk', meaning:'å–'},
      {base:'sleep', past:'slept', pp:'slept', meaning:'ç¡è§‰'},
      {base:'sing', past:'sang', pp:'sung', meaning:'å”±æ­Œ'},
      {base:'swim', past:'swam', pp:'swum', meaning:'æ¸¸æ³³'},
      {base:'break', past:'broke', pp:'broken', meaning:'æ‰“ç ´'},
      {base:'catch', past:'caught', pp:'caught', meaning:'æŠ“ä½'},
      {base:'fight', past:'fought', pp:'fought', meaning:'æˆ˜æ–—'},
      {base:'teach', past:'taught', pp:'taught', meaning:'æ•™'},
      {base:'sell', past:'sold', pp:'sold', meaning:'å–'},
      {base:'forget', past:'forgot', pp:'forgotten', meaning:'å¿˜è®°'},
      {base:'win', past:'won', pp:'won', meaning:'èµ¢'},
      {base:'ring', past:'rang', pp:'rung', meaning:'å“é“ƒ'},
      {base:'bite', past:'bit', pp:'bitten', meaning:'å’¬'},
      {base:'hide', past:'hid', pp:'hidden', meaning:'éšè—'},
      {base:'strike', past:'struck', pp:'struck', meaning:'æ‰“å‡»'},
      {base:'shake', past:'shook', pp:'shaken', meaning:'æ‘‡åŠ¨'},
      {base:'stick', past:'stuck', pp:'stuck', meaning:'ç²˜ä½'},
      {base:'shoot', past:'shot', pp:'shot', meaning:'å°„å‡»'},
      {base:'shut', past:'shut', pp:'shut', meaning:'å…³é—­'},
      {base:'hang', past:'hung', pp:'hung', meaning:'æ‚¬æŒ‚'},
      {base:'light', past:'lit', pp:'lit', meaning:'ç‚¹äº®'},
      {base:'lend', past:'lent', pp:'lent', meaning:'å€Ÿå‡º'},
      {base:'shine', past:'shone', pp:'shone', meaning:'å‘å…‰'},
      {base:'swing', past:'swung', pp:'swung', meaning:'æ‘‡æ‘†'},
      {base:'deal', past:'dealt', pp:'dealt', meaning:'å¤„ç†'},
      {base:'bet', past:'bet', pp:'bet', meaning:'æ‰“èµŒ'},
      {base:'cost', past:'cost', pp:'cost', meaning:'èŠ±è´¹'},
      {base:'fit', past:'fit', pp:'fit', meaning:'é€‚åˆ'},
      {base:'hit', past:'hit', pp:'hit', meaning:'æ‰“'},
      {base:'hurt', past:'hurt', pp:'hurt', meaning:'ä¼¤å®³'},
      {base:'quit', past:'quit', pp:'quit', meaning:'é€€å‡º'},
      {base:'split', past:'split', pp:'split', meaning:'åˆ†è£‚'},
      {base:'broadcast', past:'broadcast', pp:'broadcast', meaning:'å¹¿æ’­'},
      {base:'forgive', past:'forgave', pp:'forgiven', meaning:'åŸè°…'},
      {base:'freeze', past:'froze', pp:'frozen', meaning:'å†»ç»“'},
      {base:'tear', past:'tore', pp:'torn', meaning:'æ’•ç ´'},
      {base:'steal', past:'stole', pp:'stolen', meaning:'å·'},
      {base:'blow', past:'blew', pp:'blown', meaning:'å¹'},
      {base:'fly', past:'flew', pp:'flown', meaning:'é£'},
      {base:'bear', past:'bore', pp:'borne/born', meaning:'æ‰¿å—'},
      {base:'swear', past:'swore', pp:'sworn', meaning:'å‘èª“'},
      {base:'lay', past:'laid', pp:'laid', meaning:'æ”¾ç½®'},
      {base:'dig', past:'dug', pp:'dug', meaning:'æŒ–'},
      {base:'bleed', past:'bled', pp:'bled', meaning:'æµè¡€'},
      {base:'bind', past:'bound', pp:'bound', meaning:'ç»‘'},
      {base:'slide', past:'slid', pp:'slid', meaning:'æ»‘åŠ¨'},
      {base:'spread', past:'spread', pp:'spread', meaning:'ä¼ æ’­'},
      {base:'overcome', past:'overcame', pp:'overcome', meaning:'å…‹æœ'},
      {base:'arise', past:'arose', pp:'arisen', meaning:'å‡ºç°'},
      {base:'awake', past:'awoke', pp:'awoken', meaning:'é†’æ¥'},
      {base:'beat', past:'beat', pp:'beaten', meaning:'æ‰“'},
      {base:'bend', past:'bent', pp:'bent', meaning:'å¼¯æ›²'},
      {base:'breed', past:'bred', pp:'bred', meaning:'ç¹æ®–'},
      {base:'cling', past:'clung', pp:'clung', meaning:'ç²˜é™„'},
      {base:'creep', past:'crept', pp:'crept', meaning:'çˆ¬è¡Œ'},
      {base:'flee', past:'fled', pp:'fled', meaning:'é€ƒè·‘'},
      {base:'fling', past:'flung', pp:'flung', meaning:'æŠ•æ·'},
      {base:'grind', past:'ground', pp:'ground', meaning:'ç£¨ç¢'},
      {base:'kneel', past:'knelt', pp:'knelt', meaning:'è·ªä¸‹'},
      {base:'leap', past:'leapt', pp:'leapt', meaning:'è·³è·ƒ'},
      {base:'rid', past:'rid', pp:'rid', meaning:'æ‘†è„±'},
      {base:'seek', past:'sought', pp:'sought', meaning:'å¯»æ‰¾'},
      {base:'sew', past:'sewed', pp:'sewn/sewed', meaning:'ç¼'},
      {base:'shrink', past:'shrank', pp:'shrunk', meaning:'æ”¶ç¼©'},
      {base:'sink', past:'sank', pp:'sunk', meaning:'ä¸‹æ²‰'},
      {base:'smell', past:'smelt', pp:'smelt', meaning:'é—»'},
      {base:'spell', past:'spelt', pp:'spelt', meaning:'æ‹¼å†™'},
      {base:'spin', past:'spun', pp:'spun', meaning:'æ—‹è½¬'},
      {base:'spit', past:'spat', pp:'spat', meaning:'åç—°'},
      {base:'spring', past:'sprang', pp:'sprung', meaning:'è·³è·ƒ'},
      {base:'sting', past:'stung', pp:'stung', meaning:'åˆºç—›'},
      {base:'stink', past:'stank', pp:'stunk', meaning:'å‘è‡­'},
      {base:'stride', past:'strode', pp:'stridden', meaning:'å¤§æ­¥èµ°'},
      {base:'string', past:'strung', pp:'strung', meaning:'ä¸²èµ·'},
      {base:'strive', past:'strove', pp:'striven', meaning:'åŠªåŠ›'},
      {base:'sweep', past:'swept', pp:'swept', meaning:'æ‰“æ‰«'},
      {base:'weep', past:'wept', pp:'wept', meaning:'å“­æ³£'},
      {base:'wring', past:'wrung', pp:'wrung', meaning:'æ‹§'},
      {base:'withdraw', past:'withdrew', pp:'withdrawn', meaning:'æ’¤å›'},
      {base:'withstand', past:'withstood', pp:'withstood', meaning:'æ‰¿å—'},
      {base:'upset', past:'upset', pp:'upset', meaning:'ä½¿å¿ƒçƒ¦'},
      {base:'forecast', past:'forecast', pp:'forecast', meaning:'é¢„æŠ¥'},
      {base:'interweave', past:'interwove', pp:'interwoven', meaning:'äº¤ç»‡'},
      {base:'mislead', past:'misled', pp:'misled', meaning:'è¯¯å¯¼'},
      {base:'mistake', past:'mistook', pp:'mistaken', meaning:'è¯¯è§£'},
      {base:'overtake', past:'overtook', pp:'overtaken', meaning:'è¶…è¿‡'},
      {base:'rebuild', past:'rebuilt', pp:'rebuilt', meaning:'é‡å»º'},
      {base:'remake', past:'remade', pp:'remade', meaning:'é‡åš'},
      {base:'repay', past:'repaid', pp:'repaid', meaning:'å¿è¿˜'},
      {base:'retell', past:'retold', pp:'retold', meaning:'é‡è¿°'},
      {base:'rewrite', past:'rewrote', pp:'rewritten', meaning:'é‡å†™'},
      {base:'undertake', past:'undertook', pp:'undertaken', meaning:'æ‰¿æ‹…'}
    ];

    let order = Array.from({length: verbs.length}, (_,i)=>i);
    let idx = 0;
    let correctCount = 0;
    let wrongCount = 0;
    let totalAttempts = 0;

    const baseEl = document.getElementById('baseVerb');
    const indexEl = document.getElementById('index');
    const pastInput = document.getElementById('pastInput');
    const ppInput = document.getElementById('ppInput');
    const checkBtn = document.getElementById('checkBtn');
    const nextBtn = document.getElementById('nextBtn');
    const showBtn = document.getElementById('showBtn');
    const shuffleBtn = document.getElementById('shuffleBtn');
    const message = document.getElementById('message');
    const dot = document.getElementById('dot');
    const prog = document.getElementById('prog');
    const correctCountEl = document.getElementById('correctCount');
    const wrongCountEl = document.getElementById('wrongCount');
    const meaningEl = document.getElementById('meaning');
    const verbSelect = document.getElementById('verbSelect');
    const accuracyDisplay = document.getElementById('accuracyDisplay');

    // åŠ¨æ€ç”ŸæˆåŠ¨è¯é€‰æ‹©å™¨é€‰é¡¹
    verbs.forEach((v,i)=>{
      const option = document.createElement('option');
      option.value=i; 
      option.textContent=v.base+' - '+v.meaning;
      verbSelect.appendChild(option);
    });

    verbSelect.addEventListener('change',()=>{
      const val = verbSelect.value;
      if(val==='all') idx=0; else idx=parseInt(val);
      render();
    });

    function updateAccuracy() {
      const accuracy = totalAttempts > 0 ? Math.round((correctCount / totalAttempts) * 100) : 0;
      accuracyDisplay.textContent = `æ­£ç¡®ç‡: ${accuracy}%`;
      
      // æ ¹æ®æ­£ç¡®ç‡è®¾ç½®é¢œè‰²
      if (accuracy >= 0 && accuracy <= 50) {
        accuracyDisplay.style.background = 'linear-gradient(135deg, #ef4444, #dc2626)';
      } else if (accuracy >= 51 && accuracy <= 80) {
        accuracyDisplay.style.background = 'linear-gradient(135deg, #f97316, #ea580c)';
      } else if (accuracy >= 81 && accuracy <= 100) {
        accuracyDisplay.style.background = 'linear-gradient(135deg, #10b981, #059669)';
      }
    }

    function render(){
      const i = order[idx];
      const v = verbs[i];
      baseEl.textContent = v.base;
      meaningEl.textContent = v.meaning;
      indexEl.textContent = idx + 1;
      pastInput.value = '';
      ppInput.value = '';
      pastInput.className = 'input-field';
      ppInput.className = 'input-field';
      message.textContent = 'ç­‰å¾…è¾“å…¥ â†’ è¾“å…¥åç‚¹å‡»"æ£€æŸ¥ç­”æ¡ˆ"æˆ–æŒ‰å›è½¦';
      dot.style.background = '#fbbf24';
      updateProgress();
      pastInput.focus();
    }

    function normalize(s){return (s||'').trim().toLowerCase();}
    
    function acceptedAnswers(text){
      // å¤„ç†å¤šç§ç­”æ¡ˆæ ¼å¼ï¼š
      // 1. æ–œæ åˆ†éš”: "was/were" -> ["was", "were"]
      // 2. ç©ºæ ¼åˆ†éš”: "was were" -> ["was", "were"] 
      // 3. é€—å·åˆ†éš”: "was,were" -> ["was", "were"]
      // 4. å•ä¸ªç­”æ¡ˆ: "was" -> ["was"]
      
      // æ”¯æŒå¤šç§åˆ†éš”ç¬¦ï¼šæ–œæ ã€ç©ºæ ¼ã€é€—å·ã€åˆ†å·
      const separators = ['/', ' ', ',', ';'];
      
      // é¦–å…ˆæŒ‰æ–œæ åˆ†å‰²ï¼ˆæœ€å¸¸è§çš„æ ¼å¼ï¼‰
      let answers = text.split('/').map(x => x.trim().toLowerCase());
      
      // ç„¶åå¤„ç†æ¯ä¸ªç­”æ¡ˆä¸­å¯èƒ½åŒ…å«çš„å…¶ä»–åˆ†éš”ç¬¦
      let finalAnswers = [];
      answers.forEach(answer => {
        // æ£€æŸ¥æ˜¯å¦åŒ…å«å…¶ä»–åˆ†éš”ç¬¦
        let hasOtherSeparator = false;
        separators.forEach(sep => {
          if (answer.includes(sep)) {
            hasOtherSeparator = true;
            finalAnswers.push(...answer.split(sep).map(x => x.trim().toLowerCase()));
          }
        });
        
        // å¦‚æœæ²¡æœ‰å…¶ä»–åˆ†éš”ç¬¦ï¼Œç›´æ¥æ·»åŠ 
        if (!hasOtherSeparator) {
          finalAnswers.push(answer);
        }
      });
      
      // å»é‡å¹¶è¿‡æ»¤ç©ºå­—ç¬¦ä¸²
      return [...new Set(finalAnswers)].filter(x => x.length > 0);
    }

    function check(){
      const i = order[idx];
      const v = verbs[i];
      const userPast = normalize(pastInput.value);
      const userPP = normalize(ppInput.value);
      const pastOpts = acceptedAnswers(v.past);
      const ppOpts = acceptedAnswers(v.pp);
      
      // æ£€æŸ¥ç”¨æˆ·è¾“å…¥æ˜¯å¦åŒ…å«åˆ†éš”ç¬¦ï¼Œå¦‚æœåŒ…å«åˆ™ä¹Ÿå¤„ç†ç”¨æˆ·è¾“å…¥
      const userPastOptions = acceptedAnswers(userPast);
      const userPPOptions = acceptedAnswers(userPP);
      
      // æ£€æŸ¥ç”¨æˆ·ç­”æ¡ˆæ˜¯å¦ä¸æ­£ç¡®ç­”æ¡ˆåŒ¹é…
      const pastOK = pastOpts.includes(userPast) || 
                     userPastOptions.some(userAns => pastOpts.includes(userAns));
      const ppOK = ppOpts.includes(userPP) || 
                   userPPOptions.some(userAns => ppOpts.includes(userAns));
      
      pastInput.className = pastOK? 'input-field ok' : 'input-field bad';
      ppInput.className = ppOK? 'input-field ok' : 'input-field bad';
      
      totalAttempts++;
      
      if(pastOK && ppOK){
        message.textContent = 'å›ç­”æ­£ç¡® ğŸ‰ğŸ‰ğŸ‰';
        dot.style.background = 'var(--ok)';
        correctCount += 1;
        correctCountEl.textContent = correctCount;
        updateAccuracy();
        setTimeout(()=>{ next(false); }, 800);
      } else {
        message.textContent = 'æœ‰é”™è¯¯ï¼Œè¯·æ£€æŸ¥çº¢è‰²æ¡†æˆ–ç‚¹å‡»"æ˜¾ç¤ºç­”æ¡ˆ"æŸ¥çœ‹æ­£ç¡®ç­”æ¡ˆ';
        dot.style.background = 'var(--bad)';
        wrongCount += 1;
        wrongCountEl.textContent = wrongCount;
        updateAccuracy();
      }
    }

    function next(forceShuffleIfEnd=true){
      idx++; 
      if(idx>=order.length){
        message.textContent='ç»ƒä¹ å®Œæˆï¼ğŸŠ ç‚¹å‡»"éšæœºé¡ºåº"å†æ¬¡å¼€å§‹æˆ–ç‚¹å‡»"ä¸‹ä¸€ä¸ª"é‡æ–°å¼€å§‹ã€‚';
        dot.style.background='var(--muted)';
        idx=0; 
        correctCount=0; 
        wrongCount=0;
        correctCountEl.textContent=correctCount;
        wrongCountEl.textContent=wrongCount;
        if(forceShuffleIfEnd) shuffleOrder();
      }
      render();
    }

    function showAnswer(){
      const i = order[idx]; 
      const v = verbs[i];
      pastInput.value = v.past; 
      ppInput.value = v.pp;
      pastInput.className = 'input-field ok'; 
      ppInput.className='input-field ok';
      message.textContent = 'å·²æ˜¾ç¤ºç­”æ¡ˆ'; 
      dot.style.background='var(--accent)';
    }

    function shuffleOrder(){
      for(let i=order.length-1;i>0;i--){
        const j=Math.floor(Math.random()*(i+1)); 
        [order[i],order[j]]=[order[j],order[i]];
      }
      idx=0; 
      correctCount=0; 
      wrongCount=0;
      correctCountEl.textContent=correctCount;
      wrongCountEl.textContent=wrongCount;
      totalAttempts = 0;
      updateAccuracy();
      render();
    }

    function updateProgress(){
      const percent=Math.round((idx/order.length)*100); 
      prog.style.width=percent+'%';
    }

    // äº‹ä»¶ç›‘å¬å™¨
    checkBtn.addEventListener('click', check);
    nextBtn.addEventListener('click', ()=>next(true));
    showBtn.addEventListener('click', showAnswer);
    shuffleBtn.addEventListener('click', ()=>{ 
      shuffleOrder(); 
      message.textContent='å·²éšæœºæ‰“ä¹±é¡ºåº ğŸ”€'; 
    });
    
    [pastInput, ppInput].forEach(inp=>{
      inp.addEventListener('keydown',(e)=>{
        if(e.key==='Enter'){
          check();
        }
      });
    });
    
    // é”®ç›˜å¯¼èˆªä¼˜åŒ–
    document.addEventListener('keydown', (e) => {
      // é˜²æ­¢åœ¨è¾“å…¥æ¡†ä¸­è§¦å‘å…¨å±€å¿«æ·é”®
      if (e.target.tagName === 'INPUT' || e.target.tagName === 'SELECT') {
        return;
      }
      
      switch(e.key) {
        case ' ': // ç©ºæ ¼é”® - æ£€æŸ¥ç­”æ¡ˆ
          e.preventDefault();
          check();
          break;
        case 'ArrowRight': // å³ç®­å¤´ - ä¸‹ä¸€ä¸ª
        case 'n':
        case 'N':
          e.preventDefault();
          next(true);
          break;
        case 'ArrowLeft': // å·¦ç®­å¤´ - æ˜¾ç¤ºç­”æ¡ˆ
        case 's':
        case 'S':
          e.preventDefault();
          showAnswer();
          break;
        case 'r':
        case 'R': // Ré”® - éšæœºé¡ºåº
          e.preventDefault();
          shuffleOrder();
          message.textContent='å·²éšæœºæ‰“ä¹±é¡ºåº ğŸ”€';
          break;
        case 'Escape': // ESCé”® - æ¸…ç©ºè¾“å…¥
          e.preventDefault();
          pastInput.value = '';
          ppInput.value = '';
          pastInput.focus();
          break;
      }
    });

    // åˆå§‹åŒ–
    render();
    updateAccuracy();
    initAdaptiveFeatures(); // è°ƒç”¨è‡ªé€‚åº”åŠŸèƒ½
    
    // ä¿æŒå±å¹•å”¤é†’ï¼ˆå¦‚æœæ”¯æŒï¼‰
    if('wakeLock' in navigator){
      try{
        navigator.wakeLock.request('screen');
      }catch(e){}
    }
  </script>
</body>
</html>